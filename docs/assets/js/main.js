"use strict";const urlBase="http://api.tvmaze.com/search/shows?q=",resultList=document.getElementById("result-list"),inputElem=document.getElementById("text-input"),submitButton=document.getElementById("submit-btn"),favList=document.getElementById("fav-list");let inputValue=inputElem.value;function searchAction(){preventDefault(event),inputValue=inputElem.value,loadResults()}function preventDefault(e){e.preventDefault()}let searchList=null;const selectedContent=readLocalStorage();function loadResults(){fetch(`https://api.tvmaze.com/search/shows?q=${inputValue}`).then(e=>e.json()).then(e=>{searchList=e,renderList(searchList),console.log(searchList)})}function renderList(e){resultList.innerHTML="";for(let t of e){const e=t.show,n=document.createElement("li"),s=document.createElement("img"),i=document.createElement("div"),l=document.createElement("div"),a=document.createElement("p"),o=document.createTextNode(e.name);s.setAttribute("class","resultList-item_img"),s.setAttribute("alt","imagen de la serie"),i.setAttribute("class","resultList-item_heart"),i.setAttribute("alt","icon"),null!==e.image&&void 0!==e.image&&""!==e.image?s.setAttribute("src",e.image.medium):s.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"),a.appendChild(o),i.setAttribute("class","resultList-item_heart"),a.setAttribute("class","resultList-item_title"),l.setAttribute("class","resultList-item_content"),l.appendChild(a),l.appendChild(i),n.setAttribute("class","resultList-item"),n.setAttribute("id",t.show.id),n.appendChild(s),n.appendChild(l),resultList.appendChild(n),addClickListeners()}}function addClickListeners(){const e=document.querySelectorAll(".resultList-item");console.log(e);for(let t of e)t.addEventListener("click",selectItems)}function setLocalInfo(){localStorage.setItem("selectedItemInfo",JSON.stringify(selectedContent))}function readLocalStorage(){let e=JSON.parse(localStorage.getItem("selectedItemInfo"));return null!==e?e:[]}function getSelectedObj(e){return searchList.find(t=>t.show.id===Number.parseInt(e))}function selectItems(e){const t=e.currentTarget.id,n=getSelectedObj(t);-1===selectedContent.indexOf(t)&&(selectedContent.push(n),console.log(selectedContent),setLocalInfo(),renderFavourites(selectedContent)),removeIt()}function renderFavourites(e){favList.innerHTML="";for(let t of e){console.log(t.show);const e=document.createElement("li"),n=document.createElement("img"),s=document.createTextNode(t.show.name),i=document.createElement("span"),l=document.createElement("div"),a=document.createElement("button"),o=document.createTextNode(""),r=document.createElement("ul"),c=document.createElement("li"),d=document.createTextNode(t.show.type+"  "),u=document.createTextNode("|  "+t.show.rating.average),m=document.createTextNode("");n.setAttribute("class","favList-item_img"),n.setAttribute("alt","imagen de la serie"),n.setAttribute("width","180px"),null!==t.show.image&&void 0!==t.show.image&&""!==t.show.image?n.setAttribute("src",t.show.image.medium):n.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"),null!==t.show.rating.average&&void 0!==t.show.rating.average&&""!==t.show.rating.average?(c.appendChild(d),c.appendChild(u)):(c.appendChild(d),c.appendChild(m)),i.appendChild(s),a.setAttribute("class","fav-button"),a.appendChild(o),i.setAttribute("class","favList-item_title"),l.setAttribute("class","favList-item_content"),l.appendChild(i),l.appendChild(a),l.appendChild(r),r.appendChild(c),e.setAttribute("class","favList-item"),e.setAttribute("id",t.show.id),e.appendChild(n),e.appendChild(l),favList.appendChild(e),r.setAttribute("class","favList-item_content--list"),c.setAttribute("class","favList-item_content--list element")}addFavouriteListeners()}function addFavouriteListeners(){const e=document.querySelectorAll(".fav-button");for(let t of e)t.addEventListener("click",removeIt)}function removeIt(e){const t=e.currentTarget.parentElement.parentElement.id,n=[];for(var s=0;s<selectedContent.length;s++){const e=selectedContent[s].show.id;n.push(e)}var i=n.indexOf(parseInt(t));selectedContent.splice(i,1),setLocalInfo(),renderFavourites(selectedContent)}submitButton.addEventListener("click",searchAction),submitButton.addEventListener("click",preventDefault),renderFavourites(selectedContent);