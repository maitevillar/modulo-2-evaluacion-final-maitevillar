"use strict";const urlBase="http://api.tvmaze.com/search/shows?q=",resultList=document.querySelector(".result-list"),favList=document.querySelector(".favourite-list"),inputElem=document.querySelector("#search-name"),submitButton=document.querySelector("#submit-button");let inputValue=inputElem.value;function searchAction(){preventDefault(event),inputValue=inputElem.value,loadResults()}function preventDefault(e){e.preventDefault()}let searchList=null;const selectedContent=readLocalStorage();function loadResults(){fetch(`http://api.tvmaze.com/search/shows?q=${inputValue}`).then(e=>e.json()).then(e=>{searchList=e,renderList(searchList)})}function renderList(e){resultList.innerHTML="";for(let t of e){const e=t.show,s=document.createElement("li"),n=document.createElement("img"),i=document.createElement("img"),r=document.createElement("div"),l=document.createElement("p"),c=document.createTextNode(e.name);n.setAttribute("class","resultList-item_img"),n.setAttribute("alt","imagen de la serie"),i.setAttribute("class","resultList-item_heart"),i.setAttribute("alt","icon"),null!==e.image&&void 0!==e.image&&""!==e.image?n.setAttribute("src",e.image.medium):n.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"),l.appendChild(c),i.setAttribute("class","resultList-item_heart"),i.setAttribute("src","./assets/images/like.png"),l.setAttribute("class","resultList-item_title"),r.setAttribute("class","resultList-item_content"),r.appendChild(l),r.appendChild(i),s.setAttribute("class","resultList-item"),s.setAttribute("id",t.show.id),s.appendChild(n),s.appendChild(r),resultList.appendChild(s),addClickListeners()}}function addClickListeners(){const e=document.querySelectorAll(".resultList-item");for(let t of e)t.addEventListener("click",selectItems)}function setLocalInfo(){localStorage.setItem("selectedItemInfo",JSON.stringify(selectedContent))}function readLocalStorage(){let e=JSON.parse(localStorage.getItem("selectedItemInfo"));return null!==e?e:[]}function getSelectedObj(e){return searchList.find(t=>t.show.id===Number.parseInt(e))}function selectItems(e){const t=e.currentTarget.id,s=getSelectedObj(t);-1===selectedContent.indexOf(t)&&(selectedContent.push(s),console.log(selectedContent),setLocalInfo(),renderFavourites(selectedContent)),removeIt()}function renderFavourites(e){favList.innerHTML="";for(let t of e){const e=document.createElement("li"),s=document.createElement("img"),n=document.createTextNode(t.show.name),i=document.createElement("span"),r=document.createElement("div"),l=document.createElement("button"),c=document.createTextNode("x");s.setAttribute("class","favList-item_img"),s.setAttribute("alt","imagen de la serie"),s.setAttribute("width","180px"),null!==t.show.image&&void 0!==t.show.image&&""!==t.show.image?s.setAttribute("src",t.show.image.medium):s.setAttribute("src","https://via.placeholder.com/210x295/ffffff/666666/?text=TV"),i.appendChild(n),l.setAttribute("class","fav-button"),l.appendChild(c),i.setAttribute("class","favList-item_title"),r.setAttribute("class","favList-item_content"),r.appendChild(i),r.appendChild(l),e.setAttribute("class","favList-item"),e.setAttribute("id",t.show.id),e.appendChild(s),e.appendChild(r),favList.appendChild(e)}addFavouriteListeners()}function addFavouriteListeners(){const e=document.querySelectorAll(".fav-button");for(let t of e)t.addEventListener("click",removeIt)}function removeIt(e){const t=e.currentTarget.parentElement.id,s=selectedContent.indexOf(t);selectedContent.splice(s,1),setLocalInfo(),renderFavourites(selectedContent)}submitButton.addEventListener("click",searchAction),submitButton.addEventListener("click",preventDefault),renderFavourites(selectedContent);